# Localised wealth

# 0.01 unit of wealth = enough to sustain 1 pop (4,000 people) at subsistence level for 1 quarter-year.
# These are matched in scale to Amenities. 0.01 amenities is the base amount consumed by 1 pop

WEALTH_upper_strata_mod = {
	value = 22.8
	if = {
		limit = {
			owner = {
				has_variable = GDP_modifier
			}
		}
		multiply = owner.var:GDP_modifier
	}
}

WEALTH_middle_strata_mod = {
	value = 8.8
	if = {
		limit = {
			owner = {
				has_variable = GDP_modifier
			}
		}
		multiply = owner.var:GDP_modifier
	}
}

WEALTH_lower_strata_mod = {
	value = 1.6
	if = {
		limit = {
			owner = {
				has_variable = GDP_modifier
			}
		}
		multiply = owner.var:GDP_modifier
	}
}

WEALTH_proletariat_mod = {
	value = 1.4
	if = {
		limit = {
			owner = {
				has_variable = GDP_modifier
			}
		}
		multiply = owner.var:GDP_modifier
	}
}

WEALTH_slaves_mod = {
	value = 0.1
	if = {
		limit = {
			owner = {
				has_variable = GDP_modifier
			}
		}
		multiply = owner.var:GDP_modifier
	}
}

WEALTH_indentured_mod = {
	value = 0.6
	if = {
		limit = {
			owner = {
				has_variable = GDP_modifier
			}
		}
		multiply = owner.var:GDP_modifier
	}
}

WEALTH_tribesmen_mod = {
	value = 0.6
	if = {
		limit = {
			owner = {
				has_variable = GDP_modifier
			}
		}
		multiply = owner.var:GDP_modifier
	}
}

### Governorship level

# Values for game start
#  These values are saved into the variables on game startup, allowing for wealth to be dynamically generated
#  They are never used after game start

WEALTH_starting_upper_strata = {
	value = governorship_upper_strata
	multiply = WEALTH_upper_strata_mod
}

WEALTH_starting_middle_strata = {
	value = governorship_middle_strata
	multiply = WEALTH_middle_strata_mod
}

WEALTH_starting_lower_strata = {
	value = governorship_lower_strata
	multiply = WEALTH_lower_strata_mod
}

WEALTH_starting_proletariat = {
	value = governorship_proletariat
	multiply = WEALTH_proletariat_mod
}

WEALTH_starting_slaves = {
	value = governorship_slaves
	multiply = WEALTH_slaves_mod
}

WEALTH_starting_indentured = {
	value = governorship_indentured
	multiply = WEALTH_indentured_mod
}

WEALTH_starting_tribesmen = {
	value = governorship_tribesmen
	multiply = WEALTH_tribesmen_mod
}

# Values for province transfer from uncolonised

WEALTH_starting_upper_strata_province = {
	value = num_of_upper_strata
	multiply = WEALTH_upper_strata_mod
}

WEALTH_starting_middle_strata_province = {
	value = num_of_middle_strata
	multiply = WEALTH_middle_strata_mod
}

WEALTH_starting_lower_strata_province = {
	value = num_of_upper_strata
	multiply = WEALTH_lower_strata_mod
}

WEALTH_starting_proletariat_province = {
	value = num_of_upper_strata
	multiply = WEALTH_proletariat_mod
}

WEALTH_starting_tribesmen_province = {
	value = num_of_upper_strata
	multiply = WEALTH_tribesmen_mod
}

WEALTH_starting_slaves_province = {
	value = num_of_upper_strata
	multiply = WEALTH_slaves_mod
}

WEALTH_starting_indentured_province = {
	value = num_of_upper_strata
	multiply = WEALTH_indentured_mod
}


# Variables to svalues 

WEALTH_governorship_upper_strata = { # Amount of wealth owned by the local upper strata. Pulls from the variable.
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		value = var:upper_strata_wealth
	}
	min = 0.001
}

WEALTH_governorship_middle_strata = { # Amount of wealth owned by the local upper strata. Pulls from the variable.
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		value = var:middle_strata_wealth
	}
	min = 0.001
}

WEALTH_governorship_lower_strata = { # Amount of wealth owned by the local upper strata. Pulls from the variable.
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		value = var:lower_strata_wealth
	}
	min = 0.001
}

WEALTH_governorship_proletariat = { # Amount of wealth owned by the local proletariat. Pulls from the variable.
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		value = var:proletariat_wealth
	}
	min = 0.001
}

WEALTH_governorship_slaves = { # Amount of wealth owned by the local slaves. Pulls from the variable.
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		value = var:slaves_wealth
	}
	min = 0.001
}

WEALTH_governorship_indentured = { # Amount of wealth owned by the local upper strata. Pulls from the variable.
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		value = var:indentured_wealth
	}
	min = 0.001
}

WEALTH_governorship_tribesmen = { # Amount of wealth owned by the local tribesmen. Pulls from the variable.
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		value = var:tribesmen_wealth
	}
	min = 0.001
}

# Wealth from assets

## PROVINCE LEVEL
# Broken down by building - this is the easiest way

WEALTH_fortress_assets = {
	value = num_of_fortress_building
	multiply = 30
}

WEALTH_arsenal_assets = {
	value = num_of_arsenal_building
	multiply = 30
}

WEALTH_housing_district_assets = {
	value = num_of_URB_residential_district
	multiply = 25
}

WEALTH_cultural_district_assets = {
	value = num_of_URB_cultural_district
	multiply = 35
}

WEALTH_commerce_district_assets = {
	value = num_of_URB_commerce_district
	multiply = 25
}

WEALTH_administration_district_assets = {
	value = num_of_URB_administration_district
	multiply = 25
}

WEALTH_sewer_infrastructure_assets = {
	value = num_of_INF_sewer_infrastructure
	multiply = 25
}

WEALTH_hopsital_assets = {
	value = num_of_INF_hospital
	multiply = 25
}

WEALTH_industrial_estate_assets = {
	value = num_of_IND_industrial_estate
	multiply = 25
}

WEALTH_rgo_assets = {
	value = num_of_IND_resource_gathering_operation
	multiply = 25
}

WEALTH_university_assets = {
	value = num_of_EDU_university
	multiply = 25
}

WEALTH_school_assets = {
	value = num_of_EDU_school
	multiply = 25
}

WEALTH_school_assets = {
	value = num_of_EDU_school
	multiply = 25
}

WEALTH_railway_assets = {
	value = num_of_INF_railway_upgrade
	multiply = 25
}

WEALTH_port_assets = {
	value = num_of_port_building
	multiply = 25
}

WEALTH_total_nonpublic_assets = { # Excludes military buildings and infrastructure, except for rail
	value = num_of_used_building_slots
	subtract = num_of_fortress_building
	subtract = num_of_arsenal_building
	# TODO - errors
	# subtract = WEALTH_total_infrastructure_assets
	multiply = 25
}

## GOVERNORSHIP LEVEL

WEALTH_total_governorship_assets = {
	value = 0
	every_governorship_state = {
		every_state_province = {
			# TODO - errors
			# add = WEALTH_total_assets
			add = 1
		}
	}
}

# Caps for wealth in assets owned by pops / the state. Only upper and middle strata can own assets

WEALTH_assets_owned_upper_strata = { # The presumption is that all assets are owned by upper strata. Reforms take that away and give it to middle strata or the state.
	value = 0
}

WEALTH_assets_owned_middle_strata = {
	value = 0
}

WEALTH_assets_owned_state = {
	value = 0
}

# For funky calculations

WEALTH_governorship_total = {
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		value = var:upper_strata_wealth
		add = var:middle_strata_wealth
		add = var:lower_strata_wealth
		add = var:proletariat_wealth
		add = var:slaves_wealth
		add = var:indentured_wealth
		add = var:tribesmen_wealth
	}
}

WEALTH_governorship_per_capita = {
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		value = WEALTH_governorship_total
		divide = governorship_population
	}
	min = 0.001 # To avoid div/0
}

WEALTH_governorship_upper_strata_per_capita = {
	if = {
		limit = {
			has_global_variable = wealth_setup_done
			WEALTH_governorship_upper_strata > 0
		}
		value = WEALTH_governorship_upper_strata
		divide = governorship_upper_strata
	}
}

WEALTH_governorship_middle_strata_per_capita = {
	if = {
		limit = {
			has_global_variable = wealth_setup_done
			WEALTH_governorship_middle_strata > 0
		}
		value = WEALTH_governorship_middle_strata
		divide = governorship_middle_strata
	}
}

WEALTH_governorship_lower_strata_per_capita = {
	if = {
		limit = {
			has_global_variable = wealth_setup_done
			WEALTH_governorship_lower_strata > 0
		}
		value = WEALTH_governorship_lower_strata
		divide = governorship_lower_strata
	}
}

WEALTH_governorship_proletariat_per_capita = {
	if = {
		limit = {
			has_global_variable = wealth_setup_done
			WEALTH_governorship_proletariat > 0
		}
		value = WEALTH_governorship_proletariat
		divide = governorship_proletariat
	}
}

WEALTH_governorship_slaves_per_capita = {
	if = {
		limit = {
			has_global_variable = wealth_setup_done
			WEALTH_governorship_slaves > 0
		}
		value = WEALTH_governorship_slaves
		divide = governorship_slaves
	}
}

WEALTH_governorship_indentured_per_capita = {
	if = {
		limit = {
			has_global_variable = wealth_setup_done
			WEALTH_governorship_indentured > 0
		}
		value = WEALTH_governorship_indentured
		divide = governorship_indentured
	}
}

WEALTH_governorship_tribesmen_per_capita = {
	if = {
		limit = {
			has_global_variable = wealth_setup_done
			WEALTH_governorship_tribesmen > 0
		}
		value = WEALTH_governorship_tribesmen
		divide = governorship_tribesmen
	}
}

# NATION-LEVEL VALUES

WEALTH_total_private_moveable_wealth = {
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		every_governorships = {
			add = WEALTH_governorship_total
		}
	}
}

WEALTH_total_private_moveable_wealth_scaled = {
	value = WEALTH_total_private_moveable_wealth
	divide = 100
}

WEALTH_national_per_capita = {
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		value = WEALTH_total_private_moveable_wealth
		divide = country_population
	}
}

WEALTH_national_upper_strata = {
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		every_governorships = {
			add = var:upper_strata_wealth
		}
	}
}

WEALTH_national_middle_strata = {
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		every_governorships = {
			add = var:middle_strata_wealth
		}
	}
}

WEALTH_national_lower_strata = {
	value = 0
	if = {
		limit = {
			has_global_variable = wealth_setup_done
		}
		every_governorships = {
			add = var:lower_strata_wealth
		}
	}
}

WEALTH_national_total = {
	value = WEALTH_total_private_moveable_wealth
}

WEALTH_import_price_all_tradegoods = {
	# Scope: Country
	value = var:country_unit_price_grain
	add = var:country_unit_price_fish
	add = var:country_unit_price_livestock
	add = var:country_unit_price_vegetables
	add = var:country_unit_price_temperate_fruit
	add = var:country_unit_price_processed_foods
	add = var:country_unit_price_clothing
	add = var:country_unit_price_furniture
	add = var:country_unit_price_pharmaceuticals
	add = var:country_unit_price_coal
	add = var:country_unit_price_alcohol
	add = var:country_unit_price_gems
	add = var:country_unit_price_opium
	add = var:country_unit_price_tobacco
	add = var:country_unit_price_coffee
	add = var:country_unit_price_tea
	add = var:country_unit_price_spices
	add = var:country_unit_price_sugar
	add = var:country_unit_price_luxury_clothing
	add = var:country_unit_price_luxury_furniture
	add = var:country_unit_price_glass
	add = var:country_unit_price_motors
	add = var:country_unit_price_fur
	add = var:country_unit_price_industrial_fibres
	add = var:country_unit_price_textile_fibres
	add = var:country_unit_price_wool
	add = var:country_unit_price_silk
	add = var:country_unit_price_wood
	add = var:country_unit_price_stone
	add = var:country_unit_price_sulphur
	add = var:country_unit_price_tin
	add = var:country_unit_price_copper
	add = var:country_unit_price_iron
	add = var:country_unit_price_gold
	add = var:country_unit_price_silver
	add = var:country_unit_price_dye
	add = var:country_unit_price_lead
	add = var:country_unit_price_oil
	add = var:country_unit_price_hardwood
	add = var:country_unit_price_rubber
	add = var:country_unit_price_salt
	add = var:country_unit_price_electronics
	add = var:country_unit_price_construction_materials
	add = var:country_unit_price_steel
	add = var:country_unit_price_bronze
	add = var:country_unit_price_machine_parts
	add = var:country_unit_price_chemicals
	add = var:country_unit_price_naval_supplies
	add = var:country_unit_price_steel_ships
	add = var:country_unit_price_wooden_ships
	add = var:country_unit_price_petrochemicals
	add = var:country_unit_price_early_munitions
	add = var:country_unit_price_late_munitions
	add = var:country_unit_price_early_artillery
	add = var:country_unit_price_late_artillery
}